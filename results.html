<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Deine Ergebnisse - GBP-PRO-AUDIT</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&display=swap">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>GBP-PRO-AUDIT</h1>
      <p>Professionelle Analyse deines Google Business Profils</p>
      <div class="free-tag">Kostenlos</div>
    </header>
    
    <main>
      <!-- Lade-Animation -->
      <div id="loading-section" class="loading-container">
        <h2>Deine Ergebnisse werden geladen...</h2>
        <div class="loader"></div>
      </div>
      
      <!-- Ergebnisbereich (anfangs versteckt) -->
      <section id="results-section" class="results-container" style="display: none;">
        <h2>Deine GBP-PRO-AUDIT Ergebnisse</h2>
        
        <div class="score-display">
          <div class="score-circle">
            <span id="score-percentage">0%</span>
          </div>
          <p>Dein Google Business Profil ist zu <span id="score-text">0%</span> optimiert.</p>
        </div>
        
        <div class="results-details">
          <h3>Detaillierte Auswertung</h3>
          <div id="results-breakdown" class="results-list"></div>
        </div>
        
        <div class="recommendations">
          <h3>Personalisierte Empfehlungen</h3>
          <div id="recommendations-list" class="recommendations-list"></div>
        </div>
        
        <div class="packages">
          <h3>Unsere Optimierungs-Pakete</h3>
          <div class="packages-container">
            <!-- Basic-Paket -->
            <div class="package-card">
              <h4 class="package-title">Basic-Paket</h4>
              <div class="package-price">€198,99 <span class="original-price">€499</span></div>
              <p class="package-description">Starte mit einer grundlegenden Optimierung deines Google Business Profils.</p>
              <ul class="package-features">
                <li>Vollständiger GBP-PRO-AUDIT</li>
                <li>PDF-Auswertung des aktuellen Profils</li>
                <li>PDF-Optimierungsplan mit konkreten Maßnahmen</li>
                <li>30 Min. Telefon-Beratung</li>
                <li>Checkliste zur Selbstoptimierung</li>
              </ul>
              <p class="package-validity">Gültig bis 16.05.2025</p>
              <button class="package-btn btn-primary" data-package="Basic" onclick="requestPackage('Basic')">Paket anfragen</button>
            </div>
            
            <!-- Pro-Paket -->
            <div class="package-card">
              <h4 class="package-title">Pro-Paket</h4>
              <div class="package-price">€699</div>
              <p class="package-description">Professionelle Unterstützung für dein Google Business Profil.</p>
              <ul class="package-features">
                <li>Alle Basic-Leistungen</li>
                <li>Detaillierte Wettbewerbsanalyse (PDF)</li>
                <li>Optimierung von 3 kritischen GBP-Faktoren</li>
                <li>Erweiterte Handlungsempfehlungen</li>
                <li>Priorisierungsplan für Maßnahmen</li>
                <li>60 Min. Strategie-Beratung</li>
              </ul>
              <button class="package-btn btn-primary" data-package="Pro" onclick="requestPackage('Pro')">Paket anfragen</button>
            </div>
            
            <!-- Premium-Paket -->
            <div class="package-card">
              <h4 class="package-title">Premium-Paket</h4>
              <div class="package-price">€999</div>
              <p class="package-description">Umfassende Betreuung und Optimierung deines Google Business Profils.</p>
              <ul class="package-features">
                <li>Alle Pro-Leistungen</li>
                <li>Professionell-gestützte GBP-Komplettanalyse</li>
                <li>Monatlicher Performance-Bericht (2 Monate)</li>
                <li>Optimierung von 5 kritischen GBP-Faktoren</li>
                <li>Bewertungsmanagement-Strategie</li>
                <li>GBP-Monitoring (2 Monate)</li>
                <li>90 Min. Online-Beratung (3 x 30 Min.)</li>
              </ul>
              <button class="package-btn btn-primary" data-package="Premium" onclick="requestPackage('Premium')">Paket anfragen</button>
            </div>
          </div>
        </div>
      </section>
      
      <!-- Anfrage-Formular (versteckt) -->
      <section id="request-form-section" class="form-container" style="display: none;">
        <h2>Paket-Anfrage</h2>
        <p class="form-description">Bitte vervollständige deine Anfrage für das <span id="selected-package">Basic</span>-Paket:</p>
        
        <form name="package-request" method="POST" data-netlify="true" action="/success">
          <input type="hidden" name="form-name" value="package-request" />
          <input type="hidden" id="package-type" name="package-type" value="Basic" />
          
          <div class="form-group">
            <label for="request-name">Name:</label>
            <input type="text" id="request-name" name="name" placeholder="Dein vollständiger Name" required>
          </div>
          
          <div class="form-group">
            <label for="request-email">E-Mail:</label>
            <input type="email" id="request-email" name="email" placeholder="deine@email.de" required>
          </div>
          
          <div class="form-group">
            <label for="request-phone">Telefon:</label>
            <input type="tel" id="request-phone" name="phone" placeholder="Deine Telefonnummer" required>
          </div>
          
          <div class="form-group">
            <label for="request-message">Nachricht (optional):</label>
            <textarea id="request-message" name="message" rows="4" placeholder="Deine Nachricht oder Fragen zum Paket"></textarea>
          </div>
          
          <div class="form-check">
            <input type="checkbox" id="request-privacy" name="privacy" required>
            <label for="request-privacy">Ich habe die <a href="datenschutz.html" target="_blank">Datenschutzerklärung</a> gelesen und stimme zu.</label>
          </div>
          
          <div class="buttons-row">
            <button type="submit" class="btn btn-primary">Anfrage senden</button>
            <button type="button" class="btn btn-secondary" onclick="showResults()">Zurück zu den Ergebnissen</button>
          </div>
        </form>
      </section>
    </main>
    
    <footer>
      <p>&copy; 2025 PrintMedia Grafik + Druck e.K.. Alle Rechte vorbehalten.</p>
    </footer>
  </div>
  
  <script>
    // Hauptteil der JavaScript-Funktionalität
    document.addEventListener('DOMContentLoaded', function() {
      // Erst beim Laden der Seite den Ladebildschirm zeigen
      document.getElementById('loading-section').style.display = 'block';
      
      // Nach 1.5 Sekunden Ergebnisse anzeigen
      setTimeout(function() {
        try {
          // Ergebnisse laden und anzeigen
          loadResults();
        } catch (error) {
          console.error('Fehler beim Laden der Ergebnisse:', error);
          // Fallback: Standard-Ergebnisse anzeigen
          showDefaultResults();
        }
      }, 1500);
    });
    
    // Funktion zum Laden und Anzeigen der Ergebnisse
    function loadResults() {
      // Ladebildschirm ausblenden
      document.getElementById('loading-section').style.display = 'none';
      
      // Ergebnisbereich anzeigen
      document.getElementById('results-section').style.display = 'block';
      
      // URL-Parameter auslesen
      const urlParams = new URLSearchParams(window.location.search);
      
      // Score aus URL-Parametern oder LocalStorage holen
      let score = urlParams.get('audit-score');
      
      // Wenn kein Score in URL, im LocalStorage suchen
      if (!score) {
        try {
          const storedData = localStorage.getItem('gbp-audit-data');
          if (storedData) {
            const data = JSON.parse(storedData);
            score = data['audit-score'];
          }
        } catch (e) {
          console.warn('Fehler beim Lesen aus LocalStorage:', e);
        }
      }
      
      // Wenn immer noch kein Score, Fallback verwenden
      if (!score) {
        score = Math.floor(Math.random() * 100);
      }
      
      // Score anzeigen
      displayScore(score);
      
      // Ergebnisdetails anzeigen
      displayResults(urlParams);
      
      // Empfehlungen generieren
      generateRecommendations(score);
    }
    
    // Funktion zum Anzeigen von Standard-Ergebnissen bei Fehlern
    function showDefaultResults() {
      document.getElementById('loading-section').style.display = 'none';
      document.getElementById('results-section').style.display = 'block';
      
      // Zufälliger Score zwischen 30 und 70
      const score = Math.floor(Math.random() * 40) + 30;
      displayScore(score);
      
      // Standard-Ergebnisse anzeigen
      const resultsElement = document.getElementById('results-breakdown');
      if (resultsElement) {
        resultsElement.innerHTML = `
          <div class="result-item passed">
            <h4>1. Ist dein Google Business Profil vollständig ausgefüllt?</h4>
            <p><strong>Ja ✓</strong>: Super! Du machst das richtig.</p>
          </div>
          <div class="result-item failed">
            <h4>2. Hast du regelmäßig neue Rezensionen?</h4>
            <p><strong>Nein ✗</strong>: Hier besteht Optimierungsbedarf.</p>
          </div>
          <div class="result-item passed">
            <h4>3. Beantwortest du alle Bewertungen zeitnah?</h4>
            <p><strong>Ja ✓</strong>: Super! Du machst das richtig.</p>
          </div>
          <div class="result-item failed">
            <h4>4. Veröffentlichst du regelmäßig Google Posts?</h4>
            <p><strong>Nein ✗</strong>: Hier besteht Optimierungsbedarf.</p>
          </div>
          <div class="result-item passed">
            <h4>5. Hast du mehr als 10 hochwertige Fotos in deinem Profil?</h4>
            <p><strong>Ja ✓</strong>: Super! Du machst das richtig.</p>
          </div>
          <div class="result-item passed">
            <h4>6. Ist dein Unternehmen in den richtigen Kategorien gelistet?</h4>
            <p><strong>Ja ✓</strong>: Super! Du machst das richtig.</p>
          </div>
          <div class="result-item failed">
            <h4>7. Überwachst du regelmäßig die Insights/Statistiken?</h4>
            <p><strong>Nein ✗</strong>: Hier besteht Optimierungsbedarf.</p>
          </div>
        `;
      }
      
      // Standard-Empfehlungen generieren
      generateRecommendations(score);
    }
    
    // Funktion zum Anzeigen des Scores
    function displayScore(score) {
      const scorePercentage = document.getElementById('score-percentage');
      const scoreText = document.getElementById('score-text');
      
      if (scorePercentage) {
        scorePercentage.textContent = score + '%';
      }
      
      if (scoreText) {
        scoreText.textContent = score + '%';
      }
      
      // Score-Kreis aktualisieren
      const scoreCircle = document.querySelector('.score-circle');
      if (scoreCircle) {
        scoreCircle.style.setProperty('--percentage', score + '%');
      }
      
      // Score-Animation
      animateScore(0, parseInt(score));
    }
    
    // Funktion zur Animation des Scores
    function animateScore(start, end) {
      const scoreElement = document.getElementById('score-percentage');
      if (!scoreElement) return;
      
      let current = start;
      const increment = Math.ceil((end - start) / 30);
      const timer = setInterval(function() {
        current += increment;
        if (current >= end) {
          clearInterval(timer);
          current = end;
        }
        scoreElement.textContent = current + '%';
      }, 40);
    }
    
    // Funktion zum Anzeigen der Ergebnisse
    function displayResults(urlParams) {
      const resultsElement = document.getElementById('results-breakdown');
      if (!resultsElement) return;
      
      try {
        // Versuche, Ergebnisse aus URL-Parametern zu laden
        let results = urlParams.get('audit-results');
        
        if (results) {
          results = JSON.parse(decodeURIComponent(results));
        } else {
          // Versuche, aus LocalStorage zu laden
          const storedData = localStorage.getItem('gbp-audit-data');
          if (storedData) {
            const data = JSON.parse(storedData);
            if (data['audit-results']) {
              results = JSON.parse(decodeURIComponent(data['audit-results']));
            }
          }
        }
        
        if (results && Array.isArray(results)) {
          // Ergebnisse anzeigen
          let html = '';
          results.forEach((result, index) => {
            html += `
              <div class="result-item ${result.passed ? 'passed' : 'failed'}">
                <h4>${index + 1}. ${result.question}</h4>
                <p><strong>${result.passed ? 'Ja ✓' : 'Nein ✗'}</strong>: ${result.explanation}</p>
              </div>
            `;
          });
          resultsElement.innerHTML = html;
          return;
        }
      } catch (e) {
        console.error('Fehler beim Verarbeiten der Ergebnisse:', e);
      }
      
      // Fallback: Standard-Ergebnisse anzeigen
      resultsElement.innerHTML = '<p>Keine detaillierten Ergebnisse verfügbar.</p>';
    }
    
    // Funktion zum Generieren von Empfehlungen basierend auf dem Score
    function generateRecommendations(score) {
      const recommendationsElement = document.getElementById('recommendations-list');
      if (!recommendationsElement) return;
      
      let recommendations = [];
      
      // Empfehlungen basierend auf dem Score
      if (score < 30) {
        recommendations = [
          "Dein Google Business Profil benötigt dringend Optimierung. Wir empfehlen unser Premium-Paket für eine vollständige Überarbeitung.",
          "Beginne mit dem Hochladen hochwertiger Fotos und der Vervollständigung aller Grundinformationen.",
          "Starte mit dem Sammeln von Bewertungen deiner zufriedenen Kunden.",
          "Implementiere eine regelmäßige Strategie für Google Posts und Aktualisierungen."
        ];
      } else if (score < 70) {
        recommendations = [
          "Dein GBP hat Potential! Mit unserem Pro-Paket kannst du deine Sichtbarkeit deutlich erhöhen.",
          "Achte auf regelmäßige Posts und Updates in deinem Profil.",
          "Reagiere schneller auf Bewertungen, um die Kundenbindung zu stärken.",
          "Analysiere deine GBP-Insights regelmäßig, um deine Strategie zu optimieren."
        ];
      } else {
        recommendations = [
          "Dein GBP ist bereits gut optimiert! Mit unserem Basic-Paket kannst du den Vorsprung weiter ausbauen.",
          "Fokussiere dich auf fortgeschrittene Strategien wie lokale Veranstaltungen und spezielle Angebote.",
          "Nutze die Google Business Messenger-Funktion für besseren Kundenservice.",
          "Halte dein Profil mit regelmäßigen Updates und neuen Fotos aktuell."
        ];
      }
      
      // Empfehlungen anzeigen
      let html = '';
      recommendations.forEach((recommendation, index) => {
        html += `
          <div class="recommendation-item">
            <p><strong>${index + 1}.</strong> ${recommendation}</p>
          </div>
        `;
      });
      recommendationsElement.innerHTML = html;
    }
    
    // Funktion zum Anzeigen des Anfrage-Formulars
    function requestPackage(packageType) {
      // Pakettyp im Formular speichern
      document.getElementById('package-type').value = packageType;
      document.getElementById('selected-package').textContent = packageType;
      
      // Ergebnisbereich ausblenden
      document.getElementById('results-section').style.display = 'none';
      
      // Anfrage-Formular anzeigen
      document.getElementById('request-form-section').style.display = 'block';
      
      // Zum Formular scrollen
      document.getElementById('request-form-section').scrollIntoView({ behavior: 'smooth' });
    }
    
    // Funktion zum Zurückkehren zu den Ergebnissen
    function showResults() {
      document.getElementById('request-form-section').style.display = 'none';
      document.getElementById('results-section').style.display = 'block';
      document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
    }
  </script>
</body>
</html>
